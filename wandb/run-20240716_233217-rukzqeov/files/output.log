
Episode number:  0
Step #0.00 (0ms ?*RT. ?UPS, TraCI: 5457ms, vehicles TOT 0 ACT 0 BUF 0)
Step #300.00 (0ms ?*RT. ?UPS, TraCI: 803ms, vehicles TOT 236 ACT 62 BUF 18)
SteRewards:.00 (1ms ~= 1000.00*RT, ~93000.00UPS, TraCI: 4ms, vehicles TOT 9498 ACT 93 BUF
Episode number:  1
Step #18300.00 (1ms ~= 1000.00*RT, ~112000.00UPS, TraCI: 150ms, vehicles TOT 10027 ACT 112
Step #Rewards: (1ms ~= 1000.00*RT, ~114000.00UPS, TraCI: 1ms, vehicles TOT 9723 ACT 114 BU
Episode number:  2
Step #18300.00 (1ms ~= 1000.00*RT, ~105000.00UPS, TraCI: 94ms, vehicles TOT 10431 ACT 105
Step #167Rewards:ms ~= 1000.00*RT, ~131000.00UPS, TraCI: 1ms, vehicles TOT 9194 ACT 131 BU
Episode number:  3
Step #18300.00 (1ms ~= 1000.00*RT, ~132000.00UPS, TraCI: 121ms, vehicles TOT 10009 ACT 132
Interrupt signal received, trying to exit gracefully.CI: 0ms, vehicles TOT 8140 ACT 108 BU
<xml><var name="_dummy_ipython_val"  />
<var name="_dummy_special_var"  />
<var name="BATCH_SIZE" type="int" qualifier="builtins" value="128" />
<var name="EPS_DECAY" type="int" qualifier="builtins" value="10000" />
<var name="EPS_END" type="float" qualifier="builtins" value="0.05" />
<var name="EPS_START" type="float" qualifier="builtins" value="0.9" />
<var name="GAMMA" type="float" qualifier="builtins" value="0.99" />
<var name="LR" type="float" qualifier="builtins" value="0.0001" />
<var name="TAU" type="float" qualifier="builtins" value="0.005" />
<var name="TensorDict" type="ABCMeta" qualifier="abc" value="%3Cclass %27tensordict._td.TensorDict%27&gt;" isContainer="True" />
<var name="accelerator" type="Accelerator" qualifier="accelerate.accelerator" value="%3Caccelerate.accelerator.Accelerator object at 0x107517850&gt;" isContainer="True" />
<var name="action" type="Tensor" qualifier="torch" value="tensor%28%5B%5B3%5D%5D%2C device=%27mps%3A0%27%29" isContainer="True" shape="(1, 1)" />
<var name="cycleTime" type="int" qualifier="builtins" value="60" />
<var name="device" type="device" qualifier="torch" value="device%28type=%27mps%27%29" isContainer="True" />
<var name="done" type="bool" qualifier="builtins" value="False" />
<var name="env" type="OrderEnforcing" qualifier="gymnasium.wrappers.order_enforcing" value="%3COrderEnforcing%3CPassiveEnvChecker%3CTrafficEnv%3CTrafficEnv-V0&gt;&gt;&gt;&gt;" isContainer="True" />
<var name="episode_epsilons" type="list" qualifier="builtins" value="%5B0.8949997651975068%2C 0.8899449462276791%2C 0.8849203653666297%5D" isContainer="True" shape="3" />
<var name="episode_rewards" type="list" qualifier="builtins" value="%5B32.14791315793991%2C 32.722815096378326%2C 30.347418248653412%5D" isContainer="True" shape="3" />
<var name="eps_threshold" type="float" qualifier="builtins" value="0.8810054469144788" />
<var name="i_episode" type="int" qualifier="builtins" value="3" />
<var name="info" type="dict" qualifier="builtins" value="%7B%7D" isContainer="True" shape="0" />
<var name="initialPhaseplan" type="ndarray" qualifier="numpy" value="%5B%5B%271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %274%27 %274%27 %274%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%5D%2C %5B%271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %273%27 %273%27 %274%27 %274%27 %274%27 %274%27%5D%2C %5B%272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %273%27 %274%27 %274%27 %274%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%5D%2C %5B%272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27 %274%27 %274%27 %274%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%5D%2C %5B%271..." isContainer="True" shape="(6, 60)" />
<var name="intergreenMatrix" type="list" qualifier="builtins" value="%5B%5B0%2C 0%2C 0%2C 7%2C 6%2C 6%5D%2C %5B0%2C 0%2C 0%2C 5%2C 0%2C 0%5D%2C %5B8%2C 0%2C 0%2C 0%2C 5%2C 0%5D%2C %5B6%2C 6%2C 0%2C 0%2C 8%2C 0%5D%2C %5B8%2C 0%2C 6%2C 5%2C 0%2C 0%5D%2C %5B6%2C 0%2C 0%2C 0%2C 0%2C 0%5D%5D" isContainer="True" shape="6" />
<var name="is_ipython" type="bool" qualifier="builtins" value="True" />
<var name="key" type="str" qualifier="builtins" value="fc2.bias" />
<var name="memory" type="ReplayMemory" qualifier="__main__" value="%3C__main__.ReplayMemory object at 0x17671d410&gt;" isContainer="True" shape="226" />
<var name="minGreentime" type="int" qualifier="builtins" value="5" />
<var name="n_actions" type="int64" qualifier="numpy" value="21" isContainer="True" shape="()" />
<var name="next_state" type="TensorDict" qualifier="tensordict._td" value="TensorDict%28%0A    fields=%7B%0A        occupancy%3A Tensor%28shape=torch.Size%28%5B1%2C 6%5D%29%2C device=mps%3A0%2C dtype=torch.float32%2C is_shared=Fals...6%5D%29%2C device=mps%3A0%2C dtype=torch.float32%2C is_shared=False%29%7D%2C%0A    batch_size=torch.Size%28%5B%5D%29%2C%0A    device=None%2C%0A    is_shared=False%29" isContainer="True" shape="()" />
<var name="num_episodes" type="int" qualifier="builtins" value="600" />
<var name="numberOfPhases" type="int" qualifier="builtins" value="6" />
<var name="observation" type="dict" qualifier="builtins" value="%7B%27last_five_phaseplan%27%3A %5B%5B%5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%5D%2C%2C %5B%5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%5D%2C%2C %5B%5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%5D%2C%2C %5B%5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%5D%2C%2C %5B%5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%5D%5D%2C %27occupancy%27%3A %5B 2.7819836 87.78832    2.9901843  7.6565375  1.919614   5.5414267%5D%2C %27vehicle_count%27%3A %5B4 4 5 2 2 2%5D%7D" isContainer="True" shape="3" />
<var name="optimizer" type="AcceleratedOptimizer" qualifier="accelerate.optimizer" value="AcceleratedOptimizer %28%0AParameter Group 0%0A    amsgrad%3A True%0A    betas%3A %280.9%2C 0.999%29%0A    capturable%3A False%0A    differentiable%3A False%0A    eps%3A 1e-08%0A    foreach%3A None%0A    fused%3A None%0A    lr%3A 0.0001%0A    maximize%3A False%0A    weight_decay%3A 0.01%0A%29" isContainer="True" />
<var name="phasePlan" type="ndarray" qualifier="numpy" value="%5B%5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%5D" isContainer="True" shape="(6, 60)" />
<var name="phase_lengths" type="list" qualifier="builtins" value="%5B%5B19%2C 2%2C 14%2C 3%2C 22%5D%2C %5B41%2C 2%2C 13%2C 4%5D%2C %5B2%2C 34%2C 3%2C 21%5D%2C %5B2%2C 13%2C 3%2C 42%5D%2C %5B40%2C 2%2C 14%2C 3%2C 1%5D%2C %5B2%2C 13%2C 3%2C 42%5D%5D" isContainer="True" shape="6" />
<var name="policy_net" type="DQN" qualifier="__main__" value="DQN%28%0A  %28fc_occupancy%29%3A Linear%28in_features=6%2C out_features=64%2C bias=True%29%0A  %28fc_vehicle_count%29%3A Linear%28in_features=6%2C out_featu...e%29%0A  %28fc1%29%3A Linear%28in_features=128%2C out_features=256%2C bias=True%29%0A  %28fc2%29%3A Linear%28in_features=256%2C out_features=21%2C bias=True%29%0A%29" isContainer="True" />
<var name="policy_net_state_dict" type="OrderedDict" qualifier="collections" value="OrderedDict%28%5B%28%27fc_occupancy.weight%27%2C tensor%28%5B%5B-8.6903e-02%2C -2.8664e-01%2C -8.5050e-02%2C  2.5560e-01%2C -2.1994e-01%2C%0A          2.817...  0.0043%2C -0.0079%2C -0.0111%2C -0.0164%2C  0.0185%2C  0.0392%2C%0A         0.0413%2C  0.0259%2C  0.0078%2C  0.0277%2C -0.0569%5D%2C device=%27mps%3A0%27%29%29%5D%29" isContainer="True" shape="8" />
<var name="reward" type="Tensor" qualifier="torch" value="tensor%28%5B0.4856%5D%2C device=%27mps%3A0%27%29" isContainer="True" shape="(1,)" />
<var name="reward_per_episode" type="float" qualifier="builtins" value="23.288392275571823" />
<var name="starting_phases" type="list" qualifier="builtins" value="%5B1%2C 1%2C 2%2C 2%2C 1%2C 2%5D" isContainer="True" shape="6" />
<var name="state" type="TensorDict" qualifier="tensordict._td" value="TensorDict%28%0A    fields=%7B%0A        occupancy%3A Tensor%28shape=torch.Size%28%5B1%2C 6%5D%29%2C device=mps%3A0%2C dtype=torch.float32%2C is_shared=Fals...6%5D%29%2C device=mps%3A0%2C dtype=torch.float32%2C is_shared=False%29%7D%2C%0A    batch_size=torch.Size%28%5B%5D%29%2C%0A    device=None%2C%0A    is_shared=False%29" isContainer="True" shape="()" />
<var name="steps_done" type="int" qualifier="builtins" value="227" />
<var name="t" type="int" qualifier="builtins" value="46" />
<var name="target_net" type="DQN" qualifier="__main__" value="DQN%28%0A  %28fc_occupancy%29%3A Linear%28in_features=6%2C out_features=64%2C bias=True%29%0A  %28fc_vehicle_count%29%3A Linear%28in_features=6%2C out_featu...e%29%0A  %28fc1%29%3A Linear%28in_features=128%2C out_features=256%2C bias=True%29%0A  %28fc2%29%3A Linear%28in_features=256%2C out_features=21%2C bias=True%29%0A%29" isContainer="True" />
<var name="target_net_state_dict" type="OrderedDict" qualifier="collections" value="OrderedDict%28%5B%28%27fc_occupancy.weight%27%2C tensor%28%5B%5B-9.0773e-02%2C -2.9053e-01%2C -8.8920e-02%2C  2.5176e-01%2C -2.2382e-01%2C%0A          2.779... -0.0010%2C -0.0123%2C -0.0147%2C -0.0191%2C  0.0148%2C  0.0389%2C%0A         0.0376%2C  0.0206%2C  0.0038%2C  0.0242%2C -0.0593%5D%2C device=%27mps%3A0%27%29%29%5D%29" isContainer="True" shape="8" />
<var name="terminated" type="bool" qualifier="builtins" value="False" />
<var name="truncated" type="bool" qualifier="builtins" value="False" />
</xml>
/opt/anaconda3/envs/sumo_RL_pytorch/lib/python3.11/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.shape to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.shape` for environment variables or `env.get_wrapper_attr('shape')` that will search the reminding wrappers.
