
Episode number:  0
Step #0.00 (0ms ?*RT. ?UPS, TraCI: 6308ms, vehicles TOT 0 ACT 0 BUF 0)
Step #300.00 (0ms ?*RT. ?UPS, TraCI: 1892ms, vehicles TOT 236 ACT 62 BUF 18)

SteRewards:.00 (1ms ~= 1000.00*RT, ~119000.00UPS, TraCI: 5ms, vehicles TOT 9827 ACT 119 BU
/opt/anaconda3/envs/sumo_RL_pytorch/lib/python3.11/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.shape to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.shape` for environment variables or `env.get_wrapper_attr('shape')` that will search the reminding wrappers.
  logger.warn(
<xml><var name="_dummy_ipython_val"  />
<var name="_dummy_special_var"  />
<var name="BATCH_SIZE" type="int" qualifier="builtins" value="128" />
<var name="EPS_DECAY" type="int" qualifier="builtins" value="10000" />
<var name="EPS_END" type="float" qualifier="builtins" value="0.05" />
<var name="EPS_START" type="float" qualifier="builtins" value="0.9" />
<var name="GAMMA" type="float" qualifier="builtins" value="0.99" />
<var name="LR" type="float" qualifier="builtins" value="0.0001" />
<var name="TAU" type="float" qualifier="builtins" value="0.005" />
<var name="TensorDict" type="ABCMeta" qualifier="abc" value="%3Cclass %27tensordict._td.TensorDict%27&gt;" isContainer="True" />
<var name="accelerator" type="Accelerator" qualifier="accelerate.accelerator" value="%3Caccelerate.accelerator.Accelerator object at 0x169fcf3d0&gt;" isContainer="True" />
<var name="action" type="Tensor" qualifier="torch" value="tensor%28%5B%5B7%5D%5D%2C device=%27mps%3A0%27%29" isContainer="True" shape="(1, 1)" />
<var name="cycleTime" type="int" qualifier="builtins" value="60" />
<var name="device" type="device" qualifier="torch" value="device%28type=%27mps%27%29" isContainer="True" />
<var name="done" type="bool" qualifier="builtins" value="True" />
<var name="env" type="OrderEnforcing" qualifier="gymnasium.wrappers.order_enforcing" value="%3COrderEnforcing%3CPassiveEnvChecker%3CTrafficEnv%3CTrafficEnv-V0&gt;&gt;&gt;&gt;" isContainer="True" />
<var name="episode_epsilons" type="list" qualifier="builtins" value="%5B0.8949997651975068%5D" isContainer="True" shape="1" />
<var name="episode_rewards" type="list" qualifier="builtins" value="%5B32.87983191013336%5D" isContainer="True" shape="1" />
<var name="eps_threshold" type="float" qualifier="builtins" value="0.8949997651975068" />
<var name="i_episode" type="int" qualifier="builtins" value="0" />
<var name="info" type="dict" qualifier="builtins" value="%7B%7D" isContainer="True" shape="0" />
<var name="initialPhaseplan" type="ndarray" qualifier="numpy" value="%5B%5B%271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %274%27 %274%27 %274%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%5D%2C %5B%271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %273%27 %273%27 %274%27 %274%27 %274%27 %274%27%5D%2C %5B%272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27 %273%27%2C  %273%27 %274%27 %274%27 %274%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%5D%2C %5B%272%27 %272%27 %273%27 %273%27 %273%27 %273%27 %273%27 %274%27 %274%27 %274%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%2C  %271%27 %271%27 %271%27 %271%27 %271%27 %271%27%5D%2C %5B%271..." isContainer="True" shape="(6, 60)" />
<var name="intergreenMatrix" type="list" qualifier="builtins" value="%5B%5B0%2C 0%2C 0%2C 7%2C 6%2C 6%5D%2C %5B0%2C 0%2C 0%2C 5%2C 0%2C 0%5D%2C %5B8%2C 0%2C 0%2C 0%2C 5%2C 0%5D%2C %5B6%2C 6%2C 0%2C 0%2C 8%2C 0%5D%2C %5B8%2C 0%2C 6%2C 5%2C 0%2C 0%5D%2C %5B6%2C 0%2C 0%2C 0%2C 0%2C 0%5D%5D" isContainer="True" shape="6" />
<var name="is_ipython" type="bool" qualifier="builtins" value="True" />
<var name="key" type="str" qualifier="builtins" value="fc2.bias" />
<var name="memory" type="ReplayMemory" qualifier="__main__" value="%3C__main__.ReplayMemory object at 0x32eea7b50&gt;" isContainer="True" shape="60" />
<var name="minGreentime" type="int" qualifier="builtins" value="5" />
<var name="n_actions" type="int64" qualifier="numpy" value="21" isContainer="True" shape="()" />
<var name="next_state" type="NoneType" qualifier="builtins" value="None" />
<var name="num_episodes" type="int" qualifier="builtins" value="600" />
<var name="numberOfPhases" type="int" qualifier="builtins" value="6" />
<var name="observation" type="dict" qualifier="builtins" value="%7B%27last_five_phaseplan%27%3A %5B%5B%5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%5D%2C%2C %5B%5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%5D%2C%2C %5B%5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%5D%2C%2C %5B%5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%5D%2C%2C %5B%5B1 1 1 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 4%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%2C  %5B1 1 1 ... 4 4 1%5D%2C  %5B2 2 3 ... 1 1 1%5D%5D%5D%2C %27occupancy%27%3A %5B87.557945  70.798096  11.174496   9.217008   7.8702564  7.3251495%5D%2C %27vehicle_count%27%3A %5B 5  5 10  4  5  4%5D%7D" isContainer="True" shape="3" />
<var name="optimizer" type="AcceleratedOptimizer" qualifier="accelerate.optimizer" value="AcceleratedOptimizer %28%0AParameter Group 0%0A    amsgrad%3A True%0A    betas%3A %280.9%2C 0.999%29%0A    capturable%3A False%0A    differentiable%3A False%0A    eps%3A 1e-08%0A    foreach%3A None%0A    fused%3A None%0A    lr%3A 0.0001%0A    maximize%3A False%0A    weight_decay%3A 0.01%0A%29" isContainer="True" />
<var name="phasePlan" type="ndarray" qualifier="numpy" value="%5B%5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%2C %5B0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%2C  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0%5D%5D" isContainer="True" shape="(6, 60)" />
<var name="phase_lengths" type="list" qualifier="builtins" value="%5B%5B19%2C 2%2C 14%2C 3%2C 22%5D%2C %5B41%2C 2%2C 13%2C 4%5D%2C %5B2%2C 34%2C 3%2C 21%5D%2C %5B2%2C 13%2C 3%2C 42%5D%2C %5B40%2C 2%2C 14%2C 3%2C 1%5D%2C %5B2%2C 13%2C 3%2C 42%5D%5D" isContainer="True" shape="6" />
<var name="policy_net" type="DQN" qualifier="__main__" value="DQN%28%0A  %28fc_occupancy%29%3A Linear%28in_features=6%2C out_features=64%2C bias=True%29%0A  %28fc_vehicle_count%29%3A Linear%28in_features=6%2C out_featu...e%29%0A  %28fc1%29%3A Linear%28in_features=128%2C out_features=256%2C bias=True%29%0A  %28fc2%29%3A Linear%28in_features=256%2C out_features=21%2C bias=True%29%0A%29" isContainer="True" />
<var name="policy_net_state_dict" type="OrderedDict" qualifier="collections" value="OrderedDict%28%5B%28%27fc_occupancy.weight%27%2C tensor%28%5B%5B 0.3587%2C -0.1881%2C  0.0471%2C  0.0355%2C -0.0997%2C -0.0555%5D%2C%0A        %5B-0.1787%2C -0.0283... -0.0429%2C -0.0357%2C  0.0438%2C  0.0014%2C  0.0035%2C  0.0359%2C%0A        -0.0593%2C -0.0020%2C -0.0401%2C  0.0225%2C -0.0020%5D%2C device=%27mps%3A0%27%29%29%5D%29" isContainer="True" shape="8" />
<var name="reward" type="Tensor" qualifier="torch" value="tensor%28%5B0.4192%5D%2C device=%27mps%3A0%27%29" isContainer="True" shape="(1,)" />
<var name="reward_per_episode" type="float" qualifier="builtins" value="32.87983191013336" />
<var name="starting_phases" type="list" qualifier="builtins" value="%5B1%2C 1%2C 2%2C 2%2C 1%2C 2%5D" isContainer="True" shape="6" />
<var name="state" type="NoneType" qualifier="builtins" value="None" />
<var name="steps_done" type="int" qualifier="builtins" value="60" />
<var name="t" type="int" qualifier="builtins" value="59" />
<var name="target_net" type="DQN" qualifier="__main__" value="DQN%28%0A  %28fc_occupancy%29%3A Linear%28in_features=6%2C out_features=64%2C bias=True%29%0A  %28fc_vehicle_count%29%3A Linear%28in_features=6%2C out_featu...e%29%0A  %28fc1%29%3A Linear%28in_features=128%2C out_features=256%2C bias=True%29%0A  %28fc2%29%3A Linear%28in_features=256%2C out_features=21%2C bias=True%29%0A%29" isContainer="True" />
<var name="target_net_state_dict" type="OrderedDict" qualifier="collections" value="OrderedDict%28%5B%28%27fc_occupancy.weight%27%2C tensor%28%5B%5B 0.3587%2C -0.1881%2C  0.0471%2C  0.0355%2C -0.0997%2C -0.0555%5D%2C%0A        %5B-0.1787%2C -0.0283... -0.0429%2C -0.0357%2C  0.0438%2C  0.0014%2C  0.0035%2C  0.0359%2C%0A        -0.0593%2C -0.0020%2C -0.0401%2C  0.0225%2C -0.0020%5D%2C device=%27mps%3A0%27%29%29%5D%29" isContainer="True" shape="8" />
<var name="terminated" type="bool" qualifier="builtins" value="True" />
<var name="truncated" type="bool" qualifier="builtins" value="False" />
</xml>
Step #18300.00Interrupt signal received, trying to exit gracefully.les TOT 10149 ACT 127 B
Another interrupt signal received, hard exit.